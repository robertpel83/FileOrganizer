<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>OpenCV: Bioinspired Module Retina Introduction</title>
<link href="../../opencv.ico" rel="shortcut icon" type="image/x-icon" />
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../tutorial-utils.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
//<![CDATA[
MathJax.Hub.Config(
{
  TeX: {
      Macros: {
          matTT: [ "\\[ \\left|\\begin{array}{ccc} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{array}\\right| \\]", 9],
          fork: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ \\end{array} \\right.", 4],
          forkthree: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ \\end{array} \\right.", 6],
          forkfour: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ #7 & \\mbox{#8}\\\\ \\end{array} \\right.", 8],
          vecthree: ["\\begin{bmatrix} #1\\\\ #2\\\\ #3 \\end{bmatrix}", 3],
          vecthreethree: ["\\begin{bmatrix} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{bmatrix}", 9],
          cameramatrix: ["#1 = \\begin{bmatrix} f_x & 0 & c_x\\\\ 0 & f_y & c_y\\\\ 0 & 0 & 1 \\end{bmatrix}", 1],
          distcoeffs: ["(k_1, k_2, p_1, p_2[, k_3[, k_4, k_5, k_6 [, s_1, s_2, s_3, s_4[, \\tau_x, \\tau_y]]]]) \\text{ of 4, 5, 8, 12 or 14 elements}"],
          distcoeffsfisheye: ["(k_1, k_2, k_3, k_4)"],
          hdotsfor: ["\\dots", 1],
          mathbbm: ["\\mathbb{#1}", 1],
          bordermatrix: ["\\matrix{#1}", 1]
      }
  }
}
);
//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<!--#include virtual="/google-search.html"-->
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../opencv-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenCV
   &#160;<span id="projectnumber">4.6.0</span>
   </div>
   <div id="projectbrief">Open Source Computer Vision</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Bioinspired Module Retina Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Retina class overview </h2>
<dl class="section note"><dt>Note</dt><dd>do not forget that the retina model is included in the following namespace : <a class="el" href="../../d2/d81/namespacecv_1_1bioinspired.html">cv::bioinspired</a> with C++ and in <a class="el" href="../../d2/d81/namespacecv_1_1bioinspired.html">cv.bioinspired</a> with Python</dd></dl>
<h3>Introduction</h3>
<p>This class provides the main controls of the Gipsa/Listic labs human retina model. This is a non separable spatio-temporal filter modelling the two main retina information channels :</p>
<ul>
<li>foveal vision for detailed color vision : the parvocellular pathway.</li>
<li>peripheral vision for sensitive transient signals detection (motion and events) : the magnocellular pathway.</li>
</ul>
<p>This model originates from Jeanny Herault work <a class="el" href="../../d0/de3/citelist.html#CITEREF_Herault2010">[122]</a> . It has been involved in Alexandre Benoit phd and his current research <a class="el" href="../../d0/de3/citelist.html#CITEREF_Benoit2010">[20]</a>, <a class="el" href="../../d0/de3/citelist.html#CITEREF_Benoit2014">[234]</a> . He currently maintains this module within OpenCV. It includes the work of other Jeanny's phd student such as <a class="el" href="../../d0/de3/citelist.html#CITEREF_Chaix2007">[56]</a> and the log polar transformations of Barthelemy Durette described in Jeanny's book.</p>
<p>More into details here is an overview of the retina properties that are implemented here :</p><ul>
<li>regarding luminance and details enhancement :<ul>
<li>local logarithmic luminance compression (at the entry point by photoreceptors and at the output by ganglion cells).</li>
<li>spectral whitening at the Outer Plexiform Layer level (photoreceptors and horizontal cells spatio-temporal filtering).</li>
</ul>
</li>
</ul>
<p>The former behavior compresses luminance range and allows very bright areas and very dark ones to be visible on the same picture with lots of details. The latter reduces low frequency luminance energy (mean luminance) and enhances mid-frequencies (details). Applied all together, retina well prepares visual signals prior high level analysis. Those properties are really interesting with videos where light changes are dramatically reduced with an interesting temporal consistency.</p>
<ul>
<li>regarding noise filtering :<ul>
<li>high frequency spatial and temporal noise is filtered out. Both outputs Parvo and Magno pathways benefit from this. Noise reduction benefits from the non separable spatio-temporal filtering.</li>
<li>at the Parvo output, static textures are enhanced and noise is filtered (on videos, temporal noise is nicely removed). However, as human behaviors, moving textures are smoothed. Then, moving object details can be only enhanced if the retina tracks it and keeps it static from its point of view.</li>
<li>at Magno output, it allows a cleaner detection of events (motion, changes) with reduced noise errors even in difficult lighting conditions. As a compromise, the Magno output is a low spatial frequency signal and allows events' blobs to be reliably extracted (check the TransientAreasSegmentationModule module for that).</li>
</ul>
</li>
</ul>
<h3>Use</h3>
<p>This model can be used as a preprocessing stage in the aim of :</p>
<ul>
<li>performing texture analysis with enhanced signal to noise ratio and enhanced details which are robust against input images luminance ranges (check out the parvocellular retina channel output, by using the provided <b>getParvo</b> methods)</li>
<li>performing motion analysis that is also taking advantage of the previously cited properties (check out the magnocellular retina channel output, by using the provided <b>getMagno</b> methods)</li>
<li>general image/video sequence description using either one or both channels. An example of the use of Retina in a Bag of Words approach is given in <a class="el" href="../../d0/de3/citelist.html#CITEREF_Benoit2014">[234]</a> .</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>For ease of use in computer vision applications, the two retina channels are applied on all the input images. This does not follow the real retina topology but it is practical from an image processing point of view. If retina mapping (foveal and parafoveal vision) is required, use the log sampling capabilities proposed within the class.</li>
<li>Please do not hesitate to contribute by extending the retina description, code, use cases for complementary explanations and demonstrations.</li>
</ul>
</dd></dl>
<h3>Use case illustrations</h3>
<h4>Image preprocessing using the Parvocellular pathway (parvo retina output)</h4>
<p>As a preliminary presentation, let's start with a visual example. We propose to apply the filter on a low quality color jpeg image with backlight problems. Here is the considered input... *"Well,i could see more with my eyes than what i captured with my camera..."*</p>
<div class="image">
<img src="../../retinaInput.jpg" alt="retinaInput.jpg"/>
<div class="caption">
a low quality color jpeg image with backlight problems.</div></div>
<p> Below, the retina foveal model applied on the entire image with default parameters. Details are enforced whatever the local luminance is. Here there contours are strongly enforced but the noise level is kept low. Halo effects are voluntary visible with this configuration. See parameters discussion below and increase horizontalCellsGain near 1 to remove them.</p>
<div class="image">
<img src="../../retinaOutput_default.jpg" alt="retinaOutput_default.jpg"/>
<div class="caption">
the retina foveal model applied on the entire image with default parameters. Here contours are enforced, luminance is corrected and halo effects are voluntary visible with this configuration, increase horizontalCellsGain near 1 to remove them.</div></div>
<p> Below, a second retina foveal model output applied on the entire image with a parameters setup focused on naturalness perception. *"Hey, i now recognize my cat, looking at the mountains at the
end of the day !"*. Here contours are enforced, luminance is corrected but halos are avoided with this configuration. The backlight effect is corrected and highlight details are still preserved. Then, even on a low quality jpeg image, if some luminance's information remains, the retina is able to reconstruct a proper visual signal. Such configuration is also useful for High Dynamic Range (<em>HDR</em>) images compression to 8bit images as discussed in <a class="el" href="../../d0/de3/citelist.html#CITEREF_Benoit2010">[20]</a> and in the demonstration codes discussed below. As shown at the end of the page, parameter changes from defaults are :</p>
<ul>
<li>horizontalCellsGain=0.3</li>
<li>photoreceptorsLocalAdaptationSensitivity=ganglioncellsSensitivity=0.89.</li>
</ul>
<div class="image">
<img src="../../retinaOutput_realistic.jpg" alt="retinaOutput_realistic.jpg"/>
<div class="caption">
the retina foveal model applied on the entire image with 'naturalness' parameters. Here contours are enforced but halo effects are avoided with this configuration, horizontalCellsGain is 0.3 and photoreceptorsLocalAdaptationSensitivity=ganglioncellsSensitivity=0.89.</div></div>
<p> As observed in this preliminary demo, the retina can be settled up with various parameters, by default, as shown on the figure above, the retina strongly reduces mean luminance energy and enforces all details of the visual scene. Luminance energy and halo effects can be modulated (exaggerated to cancelled as shown on the two examples). In order to use your own parameters, you can use at least one time the <em>write(String fs)</em> method which will write a proper XML file with all default parameters. Then, tweak it on your own and reload them at any time using method <em>setup(String fs)</em>. These methods update a <em>Retina::RetinaParameters</em> member structure that is described hereafter. XML parameters file samples are shown at the end of the page.</p>
<h4>Tone mapping processing capability using the Parvocellular pathway (parvo retina output)</h4>
<p>This retina model naturally handles luminance range compression. Local adaptation stages and spectral whitening contribute to luminance range compression. In addition, high frequency noise that often corrupts tone mapped images is removed at early stages of the process thus leading to natural perception and noise free tone mapping.</p>
<p>Compared to the demos shown above, setup differences are the following ones: (see bioinspired/samples/OpenEXRimages_HDR_Retina_toneMapping.cpp for more details)</p><ul>
<li>load HDR images (OpenEXR format is supported by OpenCV) and cut histogram borders at ~5% and 95% to eliminate salt&amp;pepper like pixel's corruption.</li>
<li>apply retina with default parameters along with the following changes (generic parameters used for the presented illustrations of the section) :<ul>
<li>retina Hcells gain =0.4 (the main change compared to the default configuration : it strongly reduces halo effects)</li>
<li>localAdaptation_photoreceptors=0.99 (a little higher than default value to enforce local adaptation)</li>
<li>localAdaptation_Gcells=0.95 (also slightly higher than default for local adaptation enforcement)</li>
</ul>
</li>
<li>get the parvo output using the <em>getParvo()</em> method.</li>
</ul>
<p>Have a look at the end of this page to see how to specify these parameters in a configuration file.</p>
<p>The following two illustrations show the effect of such configuration on 2 image samples.</p>
<div class="image">
<img src="../../HDRtoneMapping_candleSample.jpg" alt="HDRtoneMapping_candleSample.jpg"/>
<div class="caption">
HDR image tone mapping example with generic parameters. Original image comes from http://openexr.com/ samples (openexr-images-1.7.0/ScanLines/CandleGlass.exr)</div></div>
 <div class="image">
<img src="../../HDRtoneMapping_memorialSample.jpg" alt="HDRtoneMapping_memorialSample.jpg"/>
<div class="caption">
HDR image tone mapping example with the same generic parameters. Original image comes from http://www.pauldebevec.com/Research/HDR/memorial.exr)</div></div>
 <h4>Motion and event detection using the Magnocellular pathway (magno retina output)</h4>
<p>Spatio-temporal events can be easily detected using <em>magno</em> output of the retina (use the <em>getMagno()</em> method). Its energy linearly increases with motion speed. An event blob detector is proposed with the TransientAreasSegmentationModule class also provided in the bioinspired module. The basic idea is to detect local energy drops with regard of the neighborhood and then to apply a threshold. Such process has been used in a bag of words description of videos on the TRECVid challenge <a class="el" href="../../d0/de3/citelist.html#CITEREF_Benoit2014">[234]</a> and only allows video frames description on transient areas.</p>
<p>We present here some illustrations of the retina outputs on some examples taken from <a href="http://changedetection.net/">http://changedetection.net/</a> with RGB and thermal videos.</p>
<dl class="section note"><dt>Note</dt><dd>here, we use the default retina setup that generates halos around strong edges. Note that temporal constants allow a temporal effect to be visible on moting objects (useful for still image illustrations of a video). Halos can be removed by increasing retina Hcells gain while temporal effects can be reduced by decreasing temporal constant values. Also take into account that the two retina outputs are rescaled in range [0:255] such that magno output can show a lot of "noise" when nothing moves while drawing it. However, its energy remains low if you retrieve it using <em>getMagnoRAW</em> getter instead.</dd></dl>
<div class="image">
<img src="../../VideoDemo_RGB_PETS2006.jpg" alt="VideoDemo_RGB_PETS2006.jpg"/>
<div class="caption">
Retina processing on RGB image sequence : example from http://changedetection.net/ (baseline/PETS2006). Parvo enforces static signals but smooths moving persons since they do not remain static from its point of view. Magno channel highligths moving persons, observe the energy mapping on the one on top, partly behind a dark glass.</div></div>
 <div class="image">
<img src="../../VideoDemo_thermal_park.jpg" alt="VideoDemo_thermal_park.jpg"/>
<div class="caption">
Retina processing on gray levels image sequence : example from http://changedetection.net/ (thermal/park). On such grayscale images, parvo channel enforces contrasts while magno strongly reacts on moving pedestrians</div></div>
 <h3>Literature</h3>
<p>For more information, refer to the following papers :</p>
<ul>
<li>Model description : <a class="el" href="../../d0/de3/citelist.html#CITEREF_Benoit2010">[20]</a></li>
<li>Model use in a Bag of Words approach : <a class="el" href="../../d0/de3/citelist.html#CITEREF_Benoit2014">[234]</a></li>
<li>Please have a look at the reference work of Jeanny Herault that you can read in his book : <a class="el" href="../../d0/de3/citelist.html#CITEREF_Herault2010">[122]</a></li>
</ul>
<p>This retina filter code includes the research contributions of phd/research colleagues from which code has been redrawn by the author :</p>
<ul>
<li>take a look at the <em>retinacolor.hpp</em> module to discover Brice Chaix de Lavarene phD color mosaicing/demosaicing and his reference paper: <a class="el" href="../../d0/de3/citelist.html#CITEREF_Chaix2007">[56]</a></li>
<li>take a look at <em>imagelogpolprojection.hpp</em> to discover retina spatial log sampling which originates from Barthelemy Durette phd with Jeanny Herault. A Retina / V1 cortex projection is also proposed and originates from Jeanny's discussions. More informations in the above cited Jeanny Heraults's book.</li>
<li>Meylan&amp;al work on HDR tone mapping that is implemented as a specific method within the model : <a class="el" href="../../d0/de3/citelist.html#CITEREF_Meylan2007">[174]</a></li>
</ul>
<h2>Retina programming interfaces </h2>
<p>The proposed class allows the <a href="http://www.gipsa-lab.inpg.fr">Gipsa</a> (preliminary work) / <a href="http://www.listic.univ-savoie.fr">Listic</a> labs retina model to be used. It can be applied on still images, images sequences and video sequences.</p>
<p>Here is an overview of the Retina interface, allocate one instance with the <em>Retina::create()</em> functions (C++, Java, Python) :</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="../../d2/d75/namespacecv.html">cv</a>{<span class="keyword">namespace </span>bioinspired{</div><div class="line"></div><div class="line"><span class="keyword">class </span>Retina : <span class="keyword">public</span> Algorithm</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <span class="comment">// parameters setup instance</span></div><div class="line">  <span class="keyword">struct </span>RetinaParameters; <span class="comment">// this class is detailed later</span></div><div class="line"></div><div class="line">  <span class="comment">// main method for input frame processing (all use method, can also perform High Dynamic Range tone mapping)</span></div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a9d18358b520c4dd7931a9154cc053649">run</a> (<a class="code" href="../../dc/d84/group__core__basic.html#ga353a9de602fe76c709e12074a6f362ba">InputArray</a> inputImage);</div><div class="line"></div><div class="line">  <span class="comment">// specific method aiming at correcting luminance only (faster High Dynamic Range tone mapping)</span></div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a1bb2ed3bee0ced414ed0533fba641dec">applyFastToneMapping</a>(<a class="code" href="../../dc/d84/group__core__basic.html#ga353a9de602fe76c709e12074a6f362ba">InputArray</a> inputImage, <a class="code" href="../../dc/d84/group__core__basic.html#gaad17fda1d0f0d1ee069aebb1df2913c0">OutputArray</a> outputToneMappedImage)</div><div class="line"></div><div class="line">  <span class="comment">// output buffers retrieval methods</span></div><div class="line">  <span class="comment">// -&gt; foveal color vision details channel with luminance and noise correction</span></div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a89bbd0119f52b9936cabdfba97561c0f">getParvo</a> (<a class="code" href="../../dc/d84/group__core__basic.html#gaad17fda1d0f0d1ee069aebb1df2913c0">OutputArray</a> retinaOutput_parvo);</div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#af1585fdd85f42ba8b79598ee1d74fcaf">getParvoRAW</a> (<a class="code" href="../../dc/d84/group__core__basic.html#gaad17fda1d0f0d1ee069aebb1df2913c0">OutputArray</a> retinaOutput_parvo);<span class="comment">// retrieve original output buffers without any normalisation</span></div><div class="line">  <span class="keyword">const</span> Mat <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#af1585fdd85f42ba8b79598ee1d74fcaf">getParvoRAW</a> () <span class="keyword">const</span>;<span class="comment">// retrieve original output buffers without any normalisation</span></div><div class="line">  <span class="comment">// -&gt; peripheral monochrome motion and events (transient information) channel</span></div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#ad8ec45e39a333eeb759e0925357f4ec5">getMagno</a> (<a class="code" href="../../dc/d84/group__core__basic.html#gaad17fda1d0f0d1ee069aebb1df2913c0">OutputArray</a> retinaOutput_magno);</div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a81377b5953ccf89c0eadf967fae2910a">getMagnoRAW</a> (<a class="code" href="../../dc/d84/group__core__basic.html#gaad17fda1d0f0d1ee069aebb1df2913c0">OutputArray</a> retinaOutput_magno); <span class="comment">// retrieve original output buffers without any normalisation</span></div><div class="line">  <span class="keyword">const</span> Mat <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a81377b5953ccf89c0eadf967fae2910a">getMagnoRAW</a> () <span class="keyword">const</span>;<span class="comment">// retrieve original output buffers without any normalisation</span></div><div class="line"></div><div class="line">  <span class="comment">// reset retina buffers... equivalent to closing your eyes for some seconds</span></div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a09603d1ed6c8f82459526bbe2ac4eac6">clearBuffers</a> ();</div><div class="line"></div><div class="line">  <span class="comment">// retrieve input and output buffers sizes</span></div><div class="line">  <a class="code" href="../../dc/d84/group__core__basic.html#ga346f563897249351a34549137c8532a0">Size</a> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a9266e82cc8de64595687f9dce2b47f87">getInputSize</a> ();</div><div class="line">  <a class="code" href="../../dc/d84/group__core__basic.html#ga346f563897249351a34549137c8532a0">Size</a> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a1a6a151832812c2b276e5cb244f7a544">getOutputSize</a> ();</div><div class="line"></div><div class="line">  <span class="comment">// setup methods with specific parameters specification of global xml config file loading/write</span></div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a741fc44059111f3e2d5ba6ab1fa1d907">setup</a> (<a class="code" href="../../dc/d84/group__core__basic.html#ga1f6634802eeadfd7245bc75cf3e216c2">String</a> retinaParameterFile=<span class="stringliteral">&quot;&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">bool</span> applyDefaultSetupOnFailure=<span class="keyword">true</span>);</div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a741fc44059111f3e2d5ba6ab1fa1d907">setup</a> (FileStorage &amp;fs, <span class="keyword">const</span> <span class="keywordtype">bool</span> applyDefaultSetupOnFailure=<span class="keyword">true</span>);</div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a741fc44059111f3e2d5ba6ab1fa1d907">setup</a> (RetinaParameters newParameters);</div><div class="line">  <span class="keyword">struct </span>Retina::RetinaParameters <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#ada6dac13985015a01a461b5cde177e95">getParameters</a> ();</div><div class="line">  <span class="keyword">const</span> <a class="code" href="../../dc/d84/group__core__basic.html#ga1f6634802eeadfd7245bc75cf3e216c2">String</a> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a933b8c74d4479727aacd919f29cf8aa8">printSetup</a> ();</div><div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a92d80a2c309c46a46b22ec125cad3943">write</a> (<a class="code" href="../../dc/d84/group__core__basic.html#ga1f6634802eeadfd7245bc75cf3e216c2">String</a> fs) <span class="keyword">const</span>;</div><div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a92d80a2c309c46a46b22ec125cad3943">write</a> (FileStorage &amp;fs) <span class="keyword">const</span>;</div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#ac6d6767e14212b5ebd7c5bbc6477fa7a">setupOPLandIPLParvoChannel</a> (<span class="keyword">const</span> <span class="keywordtype">bool</span> colorMode=<span class="keyword">true</span>, <span class="keyword">const</span> <span class="keywordtype">bool</span> normaliseOutput=<span class="keyword">true</span>, <span class="keyword">const</span> <span class="keywordtype">float</span> photoreceptorsLocalAdaptationSensitivity=0.7, <span class="keyword">const</span> <span class="keywordtype">float</span> photoreceptorsTemporalConstant=0.5, <span class="keyword">const</span> <span class="keywordtype">float</span> photoreceptorsSpatialConstant=0.53, <span class="keyword">const</span> <span class="keywordtype">float</span> horizontalCellsGain=0, <span class="keyword">const</span> <span class="keywordtype">float</span> HcellsTemporalConstant=1, <span class="keyword">const</span> <span class="keywordtype">float</span> HcellsSpatialConstant=7, <span class="keyword">const</span> <span class="keywordtype">float</span> ganglionCellsSensitivity=0.7);</div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#acfec2a2bef33e6ef73a38576f645278b">setupIPLMagnoChannel</a> (<span class="keyword">const</span> <span class="keywordtype">bool</span> normaliseOutput=<span class="keyword">true</span>, <span class="keyword">const</span> <span class="keywordtype">float</span> parasolCells_beta=0, <span class="keyword">const</span> <span class="keywordtype">float</span> parasolCells_tau=0, <span class="keyword">const</span> <span class="keywordtype">float</span> parasolCells_k=7, <span class="keyword">const</span> <span class="keywordtype">float</span> amacrinCellsTemporalCutFrequency=1.2, <span class="keyword">const</span> <span class="keywordtype">float</span> V0CompressionParameter=0.95, <span class="keyword">const</span> <span class="keywordtype">float</span> localAdaptintegration_tau=0, <span class="keyword">const</span> <span class="keywordtype">float</span> localAdaptintegration_k=7);</div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#aa66dca22cadf9293164bef39f3690a94">setColorSaturation</a> (<span class="keyword">const</span> <span class="keywordtype">bool</span> saturateColors=<span class="keyword">true</span>, <span class="keyword">const</span> <span class="keywordtype">float</span> colorSaturationValue=4.0);</div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#afe65e21f82b421cf468e225b3cd61322">activateMovingContoursProcessing</a> (<span class="keyword">const</span> <span class="keywordtype">bool</span> activate);</div><div class="line">  <span class="keywordtype">void</span> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a1e109acc73714943702572866487965b">activateContoursProcessing</a> (<span class="keyword">const</span> <span class="keywordtype">bool</span> activate);</div><div class="line">};</div><div class="line"></div><div class="line">  <span class="comment">// Allocators</span></div><div class="line">  <a class="code" href="../../dc/d84/group__core__basic.html#ga6395ca871a678020c4a31fadf7e8cc63">cv::Ptr&lt;Retina&gt;</a> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a5089c21c98da9e7ccf0a6896e7d6a400">Retina::create</a> (<a class="code" href="../../dc/d84/group__core__basic.html#ga346f563897249351a34549137c8532a0">Size</a> inputSize);</div><div class="line">  <a class="code" href="../../dc/d84/group__core__basic.html#ga6395ca871a678020c4a31fadf7e8cc63">cv::Ptr&lt;Retina&gt;</a> <a class="code" href="../../dc/d54/classcv_1_1bioinspired_1_1Retina.html#a5089c21c98da9e7ccf0a6896e7d6a400">Retina::create</a> (<a class="code" href="../../dc/d84/group__core__basic.html#ga346f563897249351a34549137c8532a0">Size</a> inputSize, <span class="keyword">const</span> <span class="keywordtype">bool</span> colorMode, RETINA_COLORSAMPLINGMETHOD colorSamplingMethod=<a class="code" href="../../dd/deb/group__bioinspired.html#gga9960117097f8d8ba20bafa0098ea20d1aaadeb7c2a3a68e14d700f15ed4323b62">RETINA_COLOR_BAYER</a>, <span class="keyword">const</span> <span class="keywordtype">bool</span> useRetinaLogSampling=<span class="keyword">false</span>, <span class="keyword">const</span> <span class="keywordtype">double</span> reductionFactor=1.0, <span class="keyword">const</span> <span class="keywordtype">double</span> samplingStrength=10.0);</div><div class="line">  }} <span class="comment">// cv and bioinspired namespaces end</span></div></div><!-- fragment --><h3>Setting up Retina</h3>
<h4>Managing the configuration file</h4>
<p>When using the <em>Retina::write</em> and <em>Retina::load</em> methods, you create or load a XML file that stores Retina configuration.</p>
<p>The default configuration is presented below.</p>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span>?&gt;</div><div class="line">&lt;<span class="keywordtype">opencv_storage</span>&gt;</div><div class="line">&lt;<span class="keywordtype">OPLandIPLparvo</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">colorMode</span>&gt;1&lt;/<span class="keywordtype">colorMode</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">normaliseOutput</span>&gt;1&lt;/<span class="keywordtype">normaliseOutput</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">photoreceptorsLocalAdaptationSensitivity</span>&gt;7.5<span class="keyword">e-01</span>&lt;/<span class="keywordtype">photoreceptorsLocalAdaptationSensitivity</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">photoreceptorsTemporalConstant</span>&gt;9.0<span class="keyword">e-01</span>&lt;/<span class="keywordtype">photoreceptorsTemporalConstant</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">photoreceptorsSpatialConstant</span>&gt;5.7<span class="keyword">e-01</span>&lt;/<span class="keywordtype">photoreceptorsSpatialConstant</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">horizontalCellsGain</span>&gt;0.01&lt;/<span class="keywordtype">horizontalCellsGain</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">hcellsTemporalConstant</span>&gt;0.5&lt;/<span class="keywordtype">hcellsTemporalConstant</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">hcellsSpatialConstant</span>&gt;7.&lt;/<span class="keywordtype">hcellsSpatialConstant</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">ganglionCellsSensitivity</span>&gt;7.5<span class="keyword">e-01</span>&lt;/<span class="keywordtype">ganglionCellsSensitivity</span>&gt;&lt;/<span class="keywordtype">OPLandIPLparvo</span>&gt;</div><div class="line">&lt;<span class="keywordtype">IPLmagno</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">normaliseOutput</span>&gt;1&lt;/<span class="keywordtype">normaliseOutput</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">parasolCells_beta</span>&gt;0.&lt;/<span class="keywordtype">parasolCells_beta</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">parasolCells_tau</span>&gt;0.&lt;/<span class="keywordtype">parasolCells_tau</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">parasolCells_k</span>&gt;7.&lt;/<span class="keywordtype">parasolCells_k</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">amacrinCellsTemporalCutFrequency</span>&gt;2.0<span class="keyword">e</span>+00&lt;/<span class="keywordtype">amacrinCellsTemporalCutFrequency</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">V0CompressionParameter</span>&gt;9.5<span class="keyword">e-01</span>&lt;/<span class="keywordtype">V0CompressionParameter</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">localAdaptintegration_tau</span>&gt;0.&lt;/<span class="keywordtype">localAdaptintegration_tau</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">localAdaptintegration_k</span>&gt;7.&lt;/<span class="keywordtype">localAdaptintegration_k</span>&gt;&lt;/<span class="keywordtype">IPLmagno</span>&gt;</div><div class="line">&lt;/<span class="keywordtype">opencv_storage</span>&gt;</div></div><!-- fragment --><p>Here are some words about all those parameters, tweak them as you wish to amplify or moderate retina effects (contours enforcement, halos effects, motion sensitivity, motion blurring, etc.)</p>
<h4>Basic parameters</h4>
<p>The simplest parameters are as follows :</p>
<ul>
<li><b>colorMode</b> : let the retina process color information (if 1) or gray scale images (if 0). In that last case, only the first channels of the input will be processed.</li>
<li><b>normaliseOutput</b> : each channel has such parameter: if the value is set to 1, then the considered channel's output is rescaled between 0 and 255. Be aware at this case of the Magnocellular output level (motion/transient channel detection). Residual noise will also be rescaled !</li>
</ul>
<p><b>Note :</b> using color requires color channels multiplexing/demultipexing which also demands more processing. You can expect much faster processing using gray levels : it would require around 30 product per pixel for all of the retina processes and it has recently been parallelized for multicore architectures.</p>
<h4>Photo-receptors parameters</h4>
<p>The following parameters act on the entry point of the retina - photo-receptors - and has impact on all of the following processes. These sensors are low pass spatio-temporal filters that smooth temporal and spatial data and also adjust their sensitivity to local luminance,thus, leads to improving details extraction and high frequency noise canceling.</p>
<ul>
<li><b>photoreceptorsLocalAdaptationSensitivity</b> between 0 and 1. Values close to 1 allow high luminance log compression's effect at the photo-receptors level. Values closer to 0 provide a more linear sensitivity. Increased alone, it can burn the <em>Parvo (details channel)</em> output image. If adjusted in collaboration with <b>ganglionCellsSensitivity</b>,images can be very contrasted whatever the local luminance there is... at the cost of a naturalness decrease.</li>
<li><b>photoreceptorsTemporalConstant</b> this setups the temporal constant of the low pass filter effect at the entry of the retina. High value leads to strong temporal smoothing effect : moving objects are blurred and can disappear while static object are favored. But when starting the retina processing, stable state is reached later.</li>
<li><b>photoreceptorsSpatialConstant</b> specifies the spatial constant related to photo-receptors' low pass filter's effect. Those parameters specify the minimum value of the spatial signal period allowed in what follows. Typically, this filter should cut high frequency noise. On the other hand, a 0 value cuts none of the noise while higher values start to cut high spatial frequencies, and progressively lower frequencies... Be aware to not go to high levels if you want to see some details of the input images ! A good compromise for color images is a 0.53 value since such choice won't affect too much the color spectrum. Higher values would lead to gray and blurred output images.</li>
</ul>
<h4>Horizontal cells parameters</h4>
<p>This parameter set tunes the neural network connected to the photo-receptors, the horizontal cells. It modulates photo-receptors sensitivity and completes the processing for final spectral whitening (part of the spatial band pass effect thus favoring visual details enhancement).</p>
<ul>
<li><b>horizontalCellsGain</b> here is a critical parameter ! If you are not interested with the mean luminance and want just to focus on details enhancement, then, set this parameterto zero. However, if you want to keep some environment luminance's data, let some low spatial frequencies pass into the system and set a higher value (&lt;1).</li>
<li><b>hcellsTemporalConstant</b> similar to photo-receptors, this parameter acts on the temporal constant of a low pass temporal filter that smoothes input data. Here, a high value generates a high retina after effect while a lower value makes the retina more reactive. This value should be lower than <b>photoreceptorsTemporalConstant</b> to limit strong retina after effects.</li>
<li><b>hcellsSpatialConstant</b> is the spatial constant of these cells filter's low pass one. It specifies the lowest spatial frequency allowed in what follows. Visually, a high value leads to very low spatial frequencies processing and leads to salient halo effects. Lower values reduce this effect but has the limit of not go lower than the value of <b>photoreceptorsSpatialConstant</b>. Those 2 parameters actually specify the spatial band-pass of the retina.</li>
</ul>
<p><b>NOTE</b> Once the processing managed by the previous parameters is done, input data is cleaned from noise and luminance is already partly enhanced. The following parameters act on the last processing stages of the two outing retina signals.</p>
<h4>Parvo (details channel) dedicated parameter</h4>
<ul>
<li><b>ganglionCellsSensitivity</b> specifies the strength of the final local adaptation occurring at the output of this details' dedicated channel. Parameter values remain between 0 and 1. Low value tend to give a linear response while higher values enforce the remaining low contrasted areas.</li>
</ul>
<p><b>Note :</b> this parameter can correct eventual burned images by favoring low energetic details of the visual scene, even in bright areas.</p>
<h4>IPL Magno (motion/transient channel) parameters</h4>
<p>Once image's information are cleaned, this channel acts as a high pass temporal filter that selects only the signals related to transient signals (events, motion, etc.). A low pass spatial filter smoothes extracted transient data while a final logarithmic compression enhances low transient events thus enhancing event sensitivity.</p>
<ul>
<li><b>parasolCells_beta</b> generally set to zero, can be considered as an amplifier gain at the entry point of this processing stage. Generally set to 0.</li>
<li><b>parasolCells_tau</b> the temporal smoothing effect that can be added</li>
<li><b>parasolCells_k</b> the spatial constant of the spatial filtering effect, set it at a high value to favor low spatial frequency signals that are lower subject for residual noise.</li>
<li><b>amacrinCellsTemporalCutFrequency</b> specifies the temporal constant of the high pass filter. High values let slow transient events to be selected.</li>
<li><b>V0CompressionParameter</b> specifies the strength of the log compression. Similar behaviors to previous description but here enforces sensitivity of transient events.</li>
<li><b>localAdaptintegration_tau</b> generally set to 0, has no real use actually in here.</li>
<li><b>localAdaptintegration_k</b> specifies the size of the area on which local adaptation is performed. Low values lead to short range local adaptation (higher sensitivity to noise), high values secure log compression.</li>
</ul>
<h3>Demos and experiments !</h3>
<h4>First time experiments</h4>
<p>Here are some code snippets to shortly show how to use Retina with default parameters (with halo effects). Next section redirects to more complete demos provided with the main retina class.</p>
<p>Here is presented how to process a webcam stream with the following steps :</p><ul>
<li>load a frist input image to get its size</li>
<li>allocate a retina instance with appropriate input size</li>
<li>loop over grabbed frames :<ul>
<li>grab a new frame</li>
<li>run on a frame</li>
<li>call the two output getters</li>
<li>display retina outputs</li>
</ul>
</li>
</ul>
<p>C++ version (see bioinspired/samples/basicRetina.cpp) :</p>
<div class="fragment"><div class="line"><span class="comment">// include bioinspired module and OpenCV core utilities</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d2/dfa/bioinspired_8hpp.html">opencv2/bioinspired.hpp</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d87/imgcodecs_8hpp.html">opencv2/imgcodecs.hpp</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../dc/d3d/videoio_8hpp.html">opencv2/videoio.hpp</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d4/dd5/highgui_8hpp.html">opencv2/highgui.hpp</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// main function</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line">    <span class="comment">// declare the retina input buffer.</span></div><div class="line">    <a class="code" href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a> inputFrame;</div><div class="line">    <span class="comment">// setup webcam reader and grab a first frame to get its size</span></div><div class="line">    <a class="code" href="../../d8/dfe/classcv_1_1VideoCapture.html">cv::VideoCapture</a> videoCapture(0); </div><div class="line">    videoCapture&gt;&gt;inputFrame;</div><div class="line"></div><div class="line">    <span class="comment">// allocate a retina instance with input size equal to the one of the loaded image</span></div><div class="line">    <a class="code" href="../../dc/d84/group__core__basic.html#ga6395ca871a678020c4a31fadf7e8cc63">cv::Ptr&lt;cv::bioinspired::Retina&gt;</a> myRetina = cv::bioinspired::createRetina(inputFrame.size());</div><div class="line"></div><div class="line">    <span class="comment">/* retina parameters management methods use sample</span></div><div class="line"><span class="comment">       -&gt; save current (here default) retina parameters to a xml file (you may use it only one time to get the file and modify it)</span></div><div class="line"><span class="comment">    */</span></div><div class="line">    myRetina-&gt;write(<span class="stringliteral">&quot;RetinaDefaultParameters.xml&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">// -&gt; load parameters if file exists</span></div><div class="line">    myRetina-&gt;setup(<span class="stringliteral">&quot;RetinaSpecificParameters.xml&quot;</span>);</div><div class="line"></div><div class="line">    <span class="comment">// reset all retina buffers (open your eyes)  </span></div><div class="line">    myRetina-&gt;clearBuffers();</div><div class="line"></div><div class="line">    <span class="comment">// declare retina output buffers</span></div><div class="line">    <a class="code" href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a> retinaOutput_parvo;</div><div class="line">    <a class="code" href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a> retinaOutput_magno;</div><div class="line"></div><div class="line">    <span class="comment">//main processing loop</span></div><div class="line">    <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div><div class="line">        <span class="comment">// if using video stream, then, grabbing a new frame, else, input remains the same</span></div><div class="line">        <span class="keywordflow">if</span> (videoCapture.isOpened())</div><div class="line">            videoCapture&gt;&gt;inputFrame;</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">imshow</a>(<span class="stringliteral">&#39;input frame&#39;</span>, inputImage)</div><div class="line">        <span class="comment">// run retina on the input image</span></div><div class="line">        myRetina-&gt;run(inputFrame);</div><div class="line">        <span class="comment">// grab retina outputs</span></div><div class="line">        myRetina-&gt;getParvo(retinaOutput_parvo);</div><div class="line">        myRetina-&gt;getMagno(retinaOutput_magno);</div><div class="line">        <span class="comment">// draw retina outputs</span></div><div class="line">        <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv::imshow</a>(<span class="stringliteral">&quot;retina input&quot;</span>, inputFrame);</div><div class="line">        <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv::imshow</a>(<span class="stringliteral">&quot;Retina Parvo&quot;</span>, retinaOutput_parvo);</div><div class="line">        <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv::imshow</a>(<span class="stringliteral">&quot;Retina Magno&quot;</span>, retinaOutput_magno);</div><div class="line">        <a class="code" href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">cv::waitKey</a>(5);</div><div class="line">        }</div><div class="line">}</div></div><!-- fragment --><p> Compile this C++ code with the following command : </p><div class="fragment"><div class="line">// compile</div><div class="line">g++ basicRetina.cpp -o basicRetina -lopencv_core -lopencv_highgui -lopencv_bioinspired -lopencv_videoio -lopencv_imgcodecs</div></div><!-- fragment --><p>Python version</p>
<div class="fragment"><div class="line"><span class="comment">#import OpenCV module</span></div><div class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</div><div class="line"></div><div class="line"><span class="comment">#setup webcam reader</span></div><div class="line">videoHandler = <a class="code" href="../../d8/dfe/classcv_1_1VideoCapture.html">cv.VideoCapture</a>(0)</div><div class="line">succeed, inputImage=videoHandler.read()</div><div class="line"></div><div class="line"><span class="comment">#allocate a retina instance with input size equal to the one of the loaded image</span></div><div class="line">retina = cv.bioinspired_Retina.create((inputImage.shape[1], inputImage.shape[0]))</div><div class="line"></div><div class="line"><span class="comment">#retina parameters management methods use sample</span></div><div class="line"><span class="comment">#-&gt; save current (here default) retina parameters to a xml file (you may use it only one time to get the file and modify it)</span></div><div class="line">retina.write(<span class="stringliteral">&#39;retinaParams.xml&#39;</span>)</div><div class="line"><span class="comment">#-&gt; load retina parameters from a xml file : here we load the default parameters that we just wrote to file</span></div><div class="line">retina.setup(<span class="stringliteral">&#39;retinaParams.xml&#39;</span>)</div><div class="line"></div><div class="line"><span class="comment">#main processing loop</span></div><div class="line">stillProcess=<span class="keyword">True</span></div><div class="line"><span class="keywordflow">while</span> stillProcess <span class="keywordflow">is</span> <span class="keyword">True</span>:</div><div class="line"></div><div class="line">    <span class="comment">#grab a new frame and display it</span></div><div class="line">    stillProcess, inputImage=videoHandler.read()</div><div class="line">    <a class="code" href="../../df/d24/group__highgui__opengl.html#gaae7e90aa3415c68dba22a5ff2cefc25d">cv.imshow</a>(<span class="stringliteral">&#39;input frame&#39;</span>, inputImage)</div><div class="line"></div><div class="line">    <span class="comment">#run retina on the input image</span></div><div class="line">    retina.run(inputImage)</div><div class="line"></div><div class="line">    <span class="comment">#grab retina outputs</span></div><div class="line">    retinaOut_parvo=retina.getParvo()</div><div class="line">    retinaOut_magno=retina.getMagno()</div><div class="line"></div><div class="line">    <span class="comment">#draw retina outputs</span></div><div class="line">    <a class="code" href="../../df/d24/group__highgui__opengl.html#gaae7e90aa3415c68dba22a5ff2cefc25d">cv.imshow</a>(<span class="stringliteral">&#39;retina parvo out&#39;</span>, retinaOut_parvo)</div><div class="line">    <a class="code" href="../../df/d24/group__highgui__opengl.html#gaae7e90aa3415c68dba22a5ff2cefc25d">cv.imshow</a>(<span class="stringliteral">&#39;retina magno out&#39;</span>, retinaOut_magno)</div><div class="line"></div><div class="line">    <span class="comment">#wait a little to let the time for figures to be drawn</span></div><div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">cv.waitKey</a>(2)</div></div><!-- fragment --><h4>More complete demos</h4>
<dl class="section note"><dt>Note</dt><dd>Complementary to the following examples, have a look at the Retina tutorial in the tutorial/contrib section for complementary explanations.**</dd></dl>
<p>Take a look at the provided C++ examples provided with OpenCV :</p>
<ul>
<li><p class="startli"><b>samples/cpp/retinademo.cpp</b> shows how to use the retina module for details enhancement (Parvo channel output) and transient maps observation (Magno channel output). You can play with images, video sequences and webcam video. Typical uses are (provided your OpenCV installation is situated in folder <em>OpenCVReleaseFolder</em>)</p><ul>
<li>image processing : <b>OpenCVReleaseFolder/bin/retinademo -image myPicture.jpg</b></li>
<li>video processing : <b>OpenCVReleaseFolder/bin/retinademo -video myMovie.avi</b></li>
<li>webcam processing: <b>OpenCVReleaseFolder/bin/retinademo -video</b></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This demo generates the file <em>RetinaDefaultParameters.xml</em> which contains the default parameters of the retina. Then, rename this as <em>RetinaSpecificParameters.xml</em>, adjust the parameters the way you want and reload the program to check the effect.</dd></dl>
</li>
<li><p class="startli"><b>samples/cpp/OpenEXRimages_HDR_Retina_toneMapping.cpp</b> shows how to use the retina to perform High Dynamic Range (HDR) luminance compression</p>
<p class="startli">Then, take a HDR image using bracketing with your camera and generate an OpenEXR image and then process it using the demo.</p>
<p class="startli">Typical use, assuming that you have the OpenEXR image such as <em>memorial.exr</em> (present in the samples/cpp/ folder)</p>
</li>
<li><p class="startli"><b>OpenCVReleaseFolder/bin/OpenEXRimages_HDR_Retina_toneMapping memorial.exr [optional: 'fast']</b></p>
<p class="startli">Note that some sliders are made available to allow you to play with luminance compression.</p>
<p class="startli">If not using the 'fast' option, then, tone mapping is performed using the full retina model <a class="el" href="../../d0/de3/citelist.html#CITEREF_Benoit2010">[20]</a> . It includes spectral whitening that allows luminance energy to be reduced. When using the 'fast' option, a simpler method is used, it is an adaptation of the algorithm presented in <a class="el" href="../../d0/de3/citelist.html#CITEREF_Meylan2007">[174]</a> . This method also gives good results and it is faster to process but it sometimes requires some more parameters adjustement. </p>
</li>
</ul>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jun 5 2022 16:19:50 for OpenCV by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
<script type="text/javascript">
//<![CDATA[
addTutorialsButtons();
//]]>
</script>
</body>
</html>
