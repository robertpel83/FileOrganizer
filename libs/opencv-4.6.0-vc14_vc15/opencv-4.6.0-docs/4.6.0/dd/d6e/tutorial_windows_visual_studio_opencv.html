<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>OpenCV: How to build applications with OpenCV inside the &quot;Microsoft Visual Studio&quot;</title>
<link href="../../opencv.ico" rel="shortcut icon" type="image/x-icon" />
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../tutorial-utils.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
//<![CDATA[
MathJax.Hub.Config(
{
  TeX: {
      Macros: {
          matTT: [ "\\[ \\left|\\begin{array}{ccc} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{array}\\right| \\]", 9],
          fork: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ \\end{array} \\right.", 4],
          forkthree: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ \\end{array} \\right.", 6],
          forkfour: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ #7 & \\mbox{#8}\\\\ \\end{array} \\right.", 8],
          vecthree: ["\\begin{bmatrix} #1\\\\ #2\\\\ #3 \\end{bmatrix}", 3],
          vecthreethree: ["\\begin{bmatrix} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{bmatrix}", 9],
          cameramatrix: ["#1 = \\begin{bmatrix} f_x & 0 & c_x\\\\ 0 & f_y & c_y\\\\ 0 & 0 & 1 \\end{bmatrix}", 1],
          distcoeffs: ["(k_1, k_2, p_1, p_2[, k_3[, k_4, k_5, k_6 [, s_1, s_2, s_3, s_4[, \\tau_x, \\tau_y]]]]) \\text{ of 4, 5, 8, 12 or 14 elements}"],
          distcoeffsfisheye: ["(k_1, k_2, k_3, k_4)"],
          hdotsfor: ["\\dots", 1],
          mathbbm: ["\\mathbb{#1}", 1],
          bordermatrix: ["\\matrix{#1}", 1]
      }
  }
}
);
//]]>
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<!--#include virtual="/google-search.html"-->
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../opencv-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenCV
   &#160;<span id="projectnumber">4.6.0</span>
   </div>
   <div id="projectbrief">Open Source Computer Vision</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d9/df8/tutorial_root.html">OpenCV Tutorials</a></li><li class="navelem"><a class="el" href="../../df/d65/tutorial_table_of_content_introduction.html">Introduction to OpenCV</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">How to build applications with OpenCV inside the "Microsoft Visual Studio" </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Prev Tutorial:</b> <a class="el" href="../../d3/d52/tutorial_windows_install.html">Installation in Windows</a></p>
<p><b>Next Tutorial:</b> <a class="el" href="../../d4/d14/tutorial_windows_visual_studio_image_watch.html">Image Watch: viewing in-memory images in the Visual Studio debugger</a></p>
<table class="doxtable">
<tr>
<th align="right"></th><th align="left"></th></tr>
<tr>
<td align="right">Original author </td><td align="left">Bernát Gábor </td></tr>
<tr>
<td align="right">Compatibility </td><td align="left">OpenCV &gt;= 3.0 </td></tr>
</table>
<dl class="section warning"><dt>Warning</dt><dd>This tutorial can contain obsolete information.</dd></dl>
<p>Everything I describe here will apply to the <code>C\C++</code> interface of OpenCV. I start out from the assumption that you have read and completed with success the <a class="el" href="../../d3/d52/tutorial_windows_install.html">Installation in Windows</a> tutorial. Therefore, before you go any further make sure you have an OpenCV directory that contains the OpenCV header files plus binaries and you have set the environment variables as described here <a class="el" href="../../d3/d52/tutorial_windows_install.html#tutorial_windows_install_path">Set the OpenCV environment variable and add it to the systems path </a>.</p>
<div class="image">
<img src="../../OpenCV_Install_Directory.jpg" alt="OpenCV_Install_Directory.jpg"/>
</div>
<p>The OpenCV libraries, distributed by us, on the Microsoft Windows operating system are in a Dynamic Linked Libraries (<em>DLL</em>). These have the advantage that all the content of the library is loaded only at runtime, on demand, and that countless programs may use the same library file. This means that if you have ten applications using the OpenCV library, no need to have around a version for each one of them. Of course you need to have the <em>dll</em> of the OpenCV on all systems where you want to run your application.</p>
<p>Another approach is to use static libraries that have <em>lib</em> extensions. You may build these by using our source files as described in the <a class="el" href="../../d3/d52/tutorial_windows_install.html">Installation in Windows</a> tutorial. When you use this the library will be built-in inside your <em>exe</em> file. So there is no chance that the user deletes them, for some reason. As a drawback your application will be larger one and as, it will take more time to load it during its startup.</p>
<p>To build an application with OpenCV you need to do two things:</p>
<ul>
<li><em>Tell</em> to the compiler how the OpenCV library <em>looks</em>. You do this by <em>showing</em> it the header files.</li>
<li><p class="startli"><em>Tell</em> to the linker from where to get the functions or data structures of OpenCV, when they are needed.</p>
<p class="startli">If you use the <em>lib</em> system you must set the path where the library files are and specify in which one of them to look. During the build the linker will look into these libraries and add the definitions and implementation of all <em>used</em> functions and data structures to the executable file.</p>
<p class="startli">If you use the <em>DLL</em> system you must again specify all this, however now for a different reason. This is a Microsoft OS specific stuff. It seems that the linker needs to know that where in the DLL to search for the data structure or function at the runtime. This information is stored inside <em>lib</em> files. Nevertheless, they aren't static libraries. They are so called import libraries. This is why when you make some <em>DLLs</em> in Windows you will also end up with some <em>lib</em> extension libraries. The good part is that at runtime only the <em>DLL</em> is required.</p>
</li>
</ul>
<p>To pass on all this information to the Visual Studio IDE you can either do it globally (so all your future projects will get this information) or locally (so only for you current project). The advantage of the global one is that you only need to do it once; however, it may be undesirable to clump all your projects all the time with all this information. In case of the global one how you do it depends on the Microsoft Visual Studio you use. There is a <b>2008 and previous versions</b> and a <b>2010 way</b> of doing it. Inside the global section of this tutorial I'll show what the main differences are.</p>
<p>The base item of a project in Visual Studio is a solution. A solution may contain multiple projects. Projects are the building blocks of an application. Every project will realize something and you will have a main project in which you can put together this project puzzle. In case of the many simple applications (like many of the tutorials will be) you do not need to break down the application into modules. In these cases, your main project will be the only existing one. Now go create a new solution inside Visual studio by going through the File &ndash;&gt; New &ndash;&gt; Project menu selection. Choose <em>Win32 Console Application</em> as type. Enter its name and select the path where to create it. Then in the upcoming dialog make sure you create an empty project.</p>
<div class="image">
<img src="../../NewProjectVisualStudio.jpg" alt="NewProjectVisualStudio.jpg"/>
</div>
<h2>The <em>local</em> method </h2>
<p>Every project is built separately from the others. Due to this every project has its own rule package. Inside this rule packages are stored all the information the <em>IDE</em> needs to know to build your project. For any application there are at least two build modes: a <em>Release</em> and a <em>Debug</em> one. The <em>Debug</em> has many features that exist so you can find and resolve easier bugs inside your application. In contrast the <em>Release</em> is an optimized version, where the goal is to make the application run as fast as possible or to be as small as possible. You may figure that these modes also require different rules to use during build. Therefore, there exist different rule packages for each of your build modes. These rule packages are called inside the IDE as <em>project properties</em> and you can view and modify them by using the <em>Property Manager</em>. You can bring this up with View &ndash;&gt; Property Pages (For Visual Studio 2013 onwards, go to View &ndash;&gt; Other Windows &ndash;&gt; Property Manager). Expand it and you can see the existing rule packages (called <em>Property Sheets</em>).</p>
<div class="image">
<img src="../../PropertyPageExample.jpg" alt="PropertyPageExample.jpg"/>
</div>
<p>The really useful stuff of these is that you may create a rule package <em>once</em> and you can later just add it to your new projects. Create it once and reuse it later. We want to create a new <em>Property Sheet</em> that will contain all the rules that the compiler and linker needs to know. Of course we will need a separate one for the Debug and the Release Builds. Start up with the Debug one as shown in the image below:</p>
<div class="image">
<img src="../../AddNewPropertySheet.jpg" alt="AddNewPropertySheet.jpg"/>
</div>
<p>Use for example the <em>OpenCV_Debug</em> name. Then by selecting the sheet Right Click &ndash;&gt; Properties. In the following I will show to set the OpenCV rules locally, as I find unnecessary to pollute projects with custom rules that I do not use it. Go the C++ groups General entry and under the *"Additional Include Directories"* add the path to your OpenCV include. If you don't have *"C/C++"* group, you should add any .c/.cpp file to the project. </p><div class="fragment"><div class="line">$(OPENCV_DIR)\..\..\include</div></div><!-- fragment --> <div class="image">
<img src="../../PropertySheetOpenCVInclude.jpg" alt="PropertySheetOpenCVInclude.jpg"/>
</div>
<p>When adding third party libraries settings it is generally a good idea to use the power behind the environment variables. The full location of the OpenCV library may change on each system. Moreover, you may even end up yourself with moving the install directory for some reason. If you would give explicit paths inside your property sheet your project will end up not working when you pass it further to someone else who has a different OpenCV install path. Moreover, fixing this would require to manually modifying every explicit path. A more elegant solution is to use the environment variables. Anything that you put inside a parenthesis started with a dollar sign will be replaced at runtime with the current environment variables value. Here comes in play the environment variable setting we already made in our previous tutorial <a class="el" href="../../d3/d52/tutorial_windows_install.html#tutorial_windows_install_path">Set the OpenCV environment variable and add it to the systems path </a>.</p>
<p>Next go to the Linker &ndash;&gt; General and under the *"Additional Library Directories"* add the libs directory: </p><div class="fragment"><div class="line">$(OPENCV_DIR)\lib</div></div><!-- fragment --><div class="image">
<img src="../../PropertySheetOpenCVLib.jpg" alt="PropertySheetOpenCVLib.jpg"/>
</div>
<p>Then you need to specify the libraries in which the linker should look into. To do this go to the Linker &ndash;&gt; Input and under the *"Additional Dependencies"* entry add the name of all modules which you want to use:</p>
<div class="image">
<img src="../../PropertySheetOpenCVLibrariesDebugSmple.jpg" alt="PropertySheetOpenCVLibrariesDebugSmple.jpg"/>
</div>
<div class="image">
<img src="../../PropertySheetOpenCVLibrariesDebug.jpg" alt="PropertySheetOpenCVLibrariesDebug.jpg"/>
</div>
<p>The names of the libraries are as follow: </p><div class="fragment"><div class="line">opencv_(The Name of the module)(The version Number of the library you use)d.lib</div></div><!-- fragment --><p> A full list, for the latest version would contain: </p><div class="fragment"><div class="line">opencv_calib3d300d.lib</div><div class="line">opencv_core300d.lib</div><div class="line">opencv_features2d300d.lib</div><div class="line">opencv_flann300d.lib</div><div class="line">opencv_highgui300d.lib</div><div class="line">opencv_imgcodecs300d.lib</div><div class="line">opencv_imgproc300d.lib</div><div class="line">opencv_ml300d.lib</div><div class="line">opencv_objdetect300d.lib</div><div class="line">opencv_photo300d.lib</div><div class="line">opencv_shape300d.lib</div><div class="line">opencv_stitching300d.lib</div><div class="line">opencv_superres300d.lib</div><div class="line">opencv_ts300d.lib</div><div class="line">opencv_video300d.lib</div><div class="line">opencv_videoio300d.lib</div><div class="line">opencv_videostab300d.lib</div></div><!-- fragment --><p>Alternatively, your OpenCV download may have been built into one large .lib file. Check by looking in OpenCV\build\architecture\vc14\lib. In this case all you would add is, for the version 3.3.0: </p><div class="fragment"><div class="line">opencv_world330.lib</div></div><!-- fragment --><p> The letter <em>d</em> at the end just indicates that these are the libraries required for the debug. Now click ok to save and do the same with a new property inside the Release rule section. Make sure to omit the <em>d</em> letters from the library names and to save the property sheets with the save icon above them.</p>
<div class="image">
<img src="../../PropertySheetOpenCVLibrariesRelease.jpg" alt="PropertySheetOpenCVLibrariesRelease.jpg"/>
</div>
<p>You can find your property sheets inside your projects directory. At this point, it is a wise decision to back them up into some special directory, to always have them at hand in the future, whenever you create an OpenCV project. Note that for Visual Studio 2010 the file extension is <em>props</em>, while for 2008 this is <em>vsprops</em>.</p>
<div class="image">
<img src="../../PropertySheetInsideFolder.jpg" alt="PropertySheetInsideFolder.jpg"/>
</div>
<p>Next time when you make a new OpenCV project just use the "Add Existing Property Sheet..." menu entry inside the Property Manager to easily add the OpenCV build rules.</p>
<div class="image">
<img src="../../PropertyPageAddExisting.jpg" alt="PropertyPageAddExisting.jpg"/>
</div>
<h2>The <em>global</em> method </h2>
<p>In case you find it too troublesome to add the property pages to each and every one of your projects you can also add this rules to a *"global property page"*. However, this applies only to the additional include and library directories. The name of the libraries to use you still need to specify manually by using for instance: a Property page.</p>
<p>In Visual Studio 2008 you can find this under the: Tools &ndash;&gt; Options &ndash;&gt; Projects and Solutions &ndash;&gt; VC++ Directories.</p>
<div class="image">
<img src="../../VCDirectories2008.jpg" alt="VCDirectories2008.jpg"/>
</div>
<p>In Visual Studio 2010 this has been moved to a global property sheet which is automatically added to every project you create:</p>
<div class="image">
<img src="../../VCDirectories2010.jpg" alt="VCDirectories2010.jpg"/>
</div>
<p>The process is the same as described in case of the local approach. Just add the include directories by using the environment variable <em>OPENCV_DIR</em>.</p>
<h2>Test it! </h2>
<p>Now to try this out download our little test <a href="https://github.com/opencv/opencv/tree/4.x/samples/cpp/tutorial_code/introduction/windows_visual_studio_opencv/introduction_windows_vs.cpp">source code</a> or get it from the sample code folder of the OpenCV sources. Add this to your project and build it. Here's its content:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d0/d9c/core_2include_2opencv2_2core_8hpp.html">opencv2/core.hpp</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d6/d87/imgcodecs_8hpp.html">opencv2/imgcodecs.hpp</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d4/dd5/highgui_8hpp.html">opencv2/highgui.hpp</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/d75/namespacecv.html">cv</a>;</div><div class="line"><span class="keyword">using namespace </span>std;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv )</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span>( argc != 2)</div><div class="line">    {</div><div class="line">     cout &lt;&lt;<span class="stringliteral">&quot; Usage: &quot;</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot; ImageToLoadAndDisplay&quot;</span> &lt;&lt; endl;</div><div class="line">     <span class="keywordflow">return</span> -1;</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> image;</div><div class="line">    image = <a class="code" href="../../d4/da8/group__imgcodecs.html#ga288b8b3da0892bd651fce07b3bbd3a56">imread</a>(argv[1], <a class="code" href="../../d8/d6a/group__imgcodecs__flags.html#gga61d9b0126a3e57d9277ac48327799c80af660544735200cbe942eea09232eb822">IMREAD_COLOR</a>); <span class="comment">// Read the file</span></div><div class="line"></div><div class="line">    <span class="keywordflow">if</span>( image.<a class="code" href="../../d3/d63/classcv_1_1Mat.html#abbec3525a852e77998aba034813fded4">empty</a>() ) <span class="comment">// Check for invalid input</span></div><div class="line">    {</div><div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Could not open or find the image&quot;</span> &lt;&lt; std::endl ;</div><div class="line">        <span class="keywordflow">return</span> -1;</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga5afdf8410934fd099df85c75b2e0888b">namedWindow</a>( <span class="stringliteral">&quot;Display window&quot;</span>, <a class="code" href="../../d0/d90/group__highgui__window__flags.html#ggabf7d2c5625bc59ac130287f925557ac3acf621ace7a54954cbac01df27e47228f">WINDOW_AUTOSIZE</a> ); <span class="comment">// Create a window for display.</span></div><div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">imshow</a>( <span class="stringliteral">&quot;Display window&quot;</span>, image ); <span class="comment">// Show our image inside it.</span></div><div class="line"></div><div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">waitKey</a>(0); <span class="comment">// Wait for a keystroke in the window</span></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p>You can start a Visual Studio build from two places. Either inside from the <em>IDE</em> (keyboard combination: Control-F5) or by navigating to your build directory and start the application with a double click. The catch is that these two <b>aren't</b> the same. When you start it from the <em>IDE</em> its current working directory is the projects directory, while otherwise it is the folder where the application file currently is (so usually your build directory). Moreover, in case of starting from the <em>IDE</em> the console window will not close once finished. It will wait for a keystroke of yours.</p>
<p>This is important to remember when you code inside the code open and save commands. Your resources will be saved ( and queried for at opening!!!) relatively to your working directory. This is unless you give a full, explicit path as a parameter for the I/O functions. In the code above we open <a href="https://github.com/opencv/opencv/tree/4.x/samples/data/opencv-logo.png">this OpenCV logo</a>. Before starting up the application, make sure you place the image file in your current working directory. Modify the image file name inside the code to try it out on other images too. Run it and voil á:</p>
<div class="image">
<img src="../../SuccessVisualStudioWindows.jpg" alt="SuccessVisualStudioWindows.jpg"/>
</div>
<h2>Command line arguments with Visual Studio </h2>
<p>Throughout some of our future tutorials, you'll see that the programs main input method will be by giving a runtime argument. To do this you can just start up a command windows (cmd + Enter in the start menu), navigate to your executable file and start it with an argument. So for example in case of my upper project this would look like: </p><div class="fragment"><div class="line">D:</div><div class="line">CD OpenCV\MySolutionName\Release</div><div class="line">MySolutionName.exe exampleImage.jpg</div></div><!-- fragment --><p> Here I first changed my drive (if your project isn't on the OS local drive), navigated to my project and start it with an example image argument. While under Linux system it is common to fiddle around with the console window on the Microsoft Windows many people come to use it almost never. Besides, adding the same argument again and again while you are testing your application is, somewhat, a cumbersome task. Luckily, in the Visual Studio there is a menu to automate all this:</p>
<div class="image">
<img src="../../VisualStudioCommandLineArguments.jpg" alt="VisualStudioCommandLineArguments.jpg"/>
</div>
<p>Specify here the name of the inputs and while you start your application from the Visual Studio environment you have automatic argument passing. In the next introductory tutorial you'll see an in-depth explanation of the upper source code: <a class="el" href="../../db/deb/tutorial_display_image.html">Getting Started with Images</a>. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jun 5 2022 16:19:54 for OpenCV by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
<script type="text/javascript">
//<![CDATA[
addTutorialsButtons();
//]]>
</script>
</body>
</html>
